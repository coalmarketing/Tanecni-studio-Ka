<header 
  class="py-2 ~px-4/8 fixed flex w-full z-50 before:absolute before:top-0 before:left-0 before:h-full before:w-full before:bg-background/80 before:border-b-2 before:border-secondary
  before:shadow-md before:-z-10 before:transition-transform before:duration-300 before:scale-y-0 before:origin-top group-[.scroll]/body:before:scale-y-100"
>
  <div class="container m-auto flex items-center">
    <!-- LOGO -->
    <div class="basis-1/3 relative flex">
      <a href="/" aria-label="Zpět na domovskou stránku">
        <img
          class="~h-14/16 w-auto transition-opacity duration-300 group-[.scroll]/body:opacity-0"
          src="/assets/svgs/TS_Ka-logo-white.svg"
          alt="Logo - Taneční studio Ká"
          width="163"
          height="64"
          loading="eager"
          decoding="async"
          aria-hidden="true"
          draggable="false">
      </a>

      <!-- SCROLL LOGO -->
      <a
        href="/"
        aria-label="Zpět na domovskou stránku"
        class="absolute p-3 bg-background border-2 border-primary shadow-md rounded-full transition-opacity duration-300 opacity-0 group-[.scroll]/body:opacity-100"
      >
        <img
          class="~h-24/28 w-auto"
          src="/assets/svgs/TS_Ka-logo_vertical_white.svg"
          alt="Logo - Taneční studio Ká"
          width="112"
          height="112"
          loading="eager"
          decoding="async"
          aria-hidden="true"
          draggable="false">
      </a>
    </div>

    <!-- NAVIGATION -->
    <nav class="xl:basis-1/3 flex justify-center">
      <ul class="flex max-lg:flex-col ~gap-4/8">
        {% set navPages = collections.all | eleventyNavigation %}

        {# Loop through all pages with a eleventyNavigation in the frontmatter #}
        {% for entry in navPages %}

          {# Define a hasChild variable to make it easier to test what navigation items are have child dropdown pages #}
          {% set hasChild = entry.children.length %}

          <li
            class="group/li relative"
            {%- if hasChild -%}tabindex="0"{%- endif -%}
          >

            {# If the page has child dropdown pages, render it as a <button> tag with the appropriate dropdown HTML #}
            {% if hasChild %}
              {# Render the <button> with the active class, dropdown icon and child links #}
              <button
                  class="dropdown-button"
                  aria-expanded="false"
                  aria-controls="dropdown-{{ entry.key }}"
                  aria-label="dropdown-{{ entry.key }}"
                  type="button"
                >
                <span>{{ entry.key }}</span>

                <!-- ICON -->
                <svg width="20" height="20" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg" fill="currentColor">
                  <path d="M8.99992 9.70969L12.4499 6.25969L13.2402 7.05L8.99992 11.2903L4.75961 7.05L5.54992 6.25969L8.99992 9.70969Z"/>
                </svg>
              </button>

              {# Dropdowns have another ul/li set up within the parent li, which gets rendered in the same way as a normal link #}
              <div>
                <ul id="dropdown-{{ entry.key }}">
                  {% for child in entry.children %}
                    <li class="drop-li inline-block">
                      <a 
                        href="{{ child.url }}"
                        class="li-link inline-block whitespace-nowrap p-2 text-sm uppercase
                        {%- if child.url == page.url %} text-black dark:text-white
                        {%- else %} text-gray-800 hover:text-black dark:text-gray-200 dark:hover:text-white{% endif %}"
                        {%- if child.url == page.url -%}aria-current="page"{%- endif -%}
                      >
                        {{ child.key }}
                      </a>
                    </li>
                  {% endfor %}
                </ul>
              </div>
            {% else %}
              {# Normal pages are rendered as <a> tags, in the normal way you'd expect #}
              <a
                class="~p-2/4 whitespace-nowrap transition-colors duration-300
                {%- if entry.url == page.url %} text-white font-semibold
                {%- else %} text-stone-200 hover:text-white{% endif %}"
                href="{{ entry.url }}"
                {%- if entry.url == page.url -%}aria-current="page"{%- endif -%}>
                {{ entry.key }}
              </a>
            {% endif %}
          </li>
        {% endfor %}
      </ul>
    </nav>

    <!-- DARKMODE + CTA -->
    <div class="basis-1/3 flex justify-end items-center ~gap-4/6">
      <!-- DARKMODE BUTTON -->
      <label for="dark-mode-toggle" class="darkmode-container">
        <span class="sr-only">Přepínač tmavého režimu</span>
        <input id="dark-mode-toggle" type="checkbox">
        <span class="planet"></span>
        <span class="elements">
          <svg
          version="1.1"
          viewBox="0 0 500 500"
          xmlns="http://www.w3.org/2000/svg">
            <polygon points="250,60 100,400 400,400"/>
          </svg>
          <svg
              version="1.1"
              viewBox="0 0 500 500"
              xmlns="http://www.w3.org/2000/svg">
            <polygon points="250,60 100,400 400,400"/>
          </svg>
          <svg
          version="1.1"
          viewBox="0 0 500 500"
          xmlns="http://www.w3.org/2000/svg">
            <polygon points="250,60 100,400 400,400"/>
          </svg>
          <svg
          version="1.1"
          viewBox="0 0 500 500"
          xmlns="http://www.w3.org/2000/svg">
            <polygon points="250,60 100,400 400,400"/>
          </svg>
          <svg
          version="1.1"
          viewBox="0 0 500 500"
          xmlns="http://www.w3.org/2000/svg">
            <polygon points="250,60 100,400 400,400"/>
          </svg>
          <svg
          version="1.1"
          viewBox="0 0 500 500"
          xmlns="http://www.w3.org/2000/svg">
            <polygon points="250,60 100,400 400,400"/>
          </svg>
          <svg
          version="1.1"
          viewBox="0 0 500 500"
          xmlns="http://www.w3.org/2000/svg">
            <polygon points="250,60 100,400 400,400"/>
          </svg>
          <svg
          version="1.1"
          viewBox="0 0 500 500"
          xmlns="http://www.w3.org/2000/svg">
            <polygon points="250,60 100,400 400,400"/>
          </svg>
          <svg
          version="1.1"
          viewBox="0 0 500 500"
          xmlns="http://www.w3.org/2000/svg">
            <circle
            cx="250"
            cy="250"
            r="200"/>
          </svg>
          <svg
          version="1.1"
          viewBox="0 0 500 500"
          xmlns="http://www.w3.org/2000/svg">
            <circle
            cx="250"
            cy="250"
            r="200"/>
          </svg>
          <svg
          version="1.1"
          viewBox="0 0 500 500"
          xmlns="http://www.w3.org/2000/svg">
            <circle
            cx="250"
            cy="250"
            r="200"/>
          </svg>
        </span>
      </label>

      <!-- CTA -->
      <a href="https://www.google.com/" target="_blank" class="btn max-lg:hidden">
        Rezervace
      </a>

      <!-- MOBILE MENU BUTTON -->
      <button
        id="mobile-menu-toggle"
        class="group lg:hidden flex justify-center items-center gap-1 h-11 w-11 bg-stone-200/75 rounded-xl transition-transform duration-300 [&.active]:rotate-90"
        type="button"
        aria-expanded="false"
      >
        <span class="sr-only">Otevřít navigaci</span>
        <span class="relative block h-3.5 w-5">
          <span class="absolute top-0 block h-0.5 w-full bg-stone-800 rounded-full transition-transform duration-300 group-[.active]:rotate-45 group-[.active]:top-1/2 group-[.active]:-translate-y-1/2 group-[.active]:left-1/2 group-[.active]:-translate-x-1/2"></span>
          <span class="absolute top-1/2 -translate-y-1/2 block h-0.5 w-full bg-stone-800 rounded-full transition-[opacity] duration-300 group-[.active]:opacity-0"></span>
          <span class="absolute bottom-0 block h-0.5 w-full bg-stone-800 rounded-full transition-transform duration-300 group-[.active]:rotate-[315deg] group-[.active]:top-1/2 group-[.active]:-translate-y-1/2 group-[.active]:left-1/2 group-[.active]:-translate-x-1/2"></span>
        </span>
      </button>
    </div>
  </div>
</header>